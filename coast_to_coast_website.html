<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Coast to Coast Walk 2025</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lora:wght@400;700&family=Lato:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Lato", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, sans-serif;
        line-height: 1.6;
        color: #333;
        background-color: #f4f4f4;
        min-height: 100vh;
        scroll-behavior: smooth;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      .hero {
        text-align: center;
        padding: 80px 40px;
        color: white;
        margin-bottom: 40px;
        position: relative;
        background-image: url("images/hero-background.jpg");"
        background-size: cover;
        background-position: center;
        border-radius: 0 0 30px 30px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .hero::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.45);
        z-index: 1;
      }

      .hero > * {
        position: relative;
        z-index: 2;
      }

      .hero h1 {
        font-family: "Lora", serif;
        font-size: 4.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.6);
      }

      .hero p {
        font-family: "Lato", sans-serif;
        font-size: 1.5rem;
        margin-bottom: 30px;
        opacity: 0.9;
        font-weight: 400;
      }

      .weather-container {
        background: rgba(0, 0, 0, 0.25);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 20px;
        max-width: 600px;
        margin: 20px auto 40px auto;
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .weather-location {
        font-family: "Lora", serif;
        font-size: 1.5rem;
        margin-bottom: 15px;
      }

      .forecast {
        display: flex;
        justify-content: space-around;
        gap: 10px;
      }

      .forecast-day {
        text-align: center;
      }

      .forecast-day .day-name {
        font-weight: bold;
        font-size: 0.9rem;
      }

      .forecast-day .icon {
        font-size: 2rem;
        margin: 5px 0;
      }

      .forecast-day .temps {
        font-size: 0.9rem;
      }

      .stats {
        display: flex;
        justify-content: center;
        gap: 40px;
        flex-wrap: wrap;
        margin-top: 30px;
      }

      .stat {
        text-align: center;
        background: rgba(255, 255, 255, 0.15);
        padding: 20px;
        border-radius: 15px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
      }

      .countdown-container {
        margin-top: 40px;
        padding: 25px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 20px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        max-width: 500px;
        margin-left: auto;
        margin-right: auto;
      }

      .countdown-title {
        font-size: 1.1rem;
        margin-bottom: 15px;
        opacity: 0.9;
      }

      .countdown {
        display: flex;
        justify-content: center;
        gap: 30px;
        flex-wrap: wrap;
      }

      .countdown-item {
        text-align: center;
      }

      .countdown-value {
        display: block;
        font-size: 2rem;
        font-weight: bold;
        margin-bottom: 5px;
      }

      .countdown-label {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      .stat-number {
        font-size: 2.5rem;
        font-weight: bold;
        display: block;
      }

      .stat-label {
        font-size: 0.9rem;
        opacity: 0.8;
      }

      #timelineContainer {
        background-color: #ffffff;
        background-image: url("https://www.transparenttextures.com/patterns/light-paper-fibers.png");
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        margin-bottom: 40px;
      }

      #timelineContainer h2 {
        font-family: "Lora", serif;
        text-align: center;
        margin-bottom: 50px;
        font-size: 2.8rem;
        color: #2c3e50;
        font-weight: 700;
      }

      .day {
        margin-bottom: 20px;
        border-radius: 18px;
        background: #ffffff;
        border: 1px solid #e2e8f0;
        transition: all 0.3s ease;
        position: relative;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);
        overflow: hidden;
      }

      .day-header {
        display: flex;
        padding: 30px;
        cursor: pointer;
        border-left: 6px solid #4a5568; /* Slate Grey */
      }

      .day:hover .day-header {
        border-left-color: #576c8a; /* Heather Purple */
      }

      .day.completed .day-header {
        border-left-color: #a0aec0;
        opacity: 0.7;
      }

      .day.today .day-header {
        border-left-color: #48bb78; /* Green */
      }

      .day-number {
        background: #4a5568; /* Slate Grey */
        color: white;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.2rem;
        margin-right: 25px;
        flex-shrink: 0;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }

      .day.completed .day-number {
        background: #a0aec0;
      }

      .day.today .day-number {
        background: #48bb78;
      }

      .day-number span {
        position: relative;
        z-index: 2;
      }

      .day-number::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #576c8a; /* Heather Purple */
        opacity: 0;
        transition: opacity 0.3s ease;
        border-radius: 50%;
        z-index: 1;
      }

      .day:hover .day-number::before {
        opacity: 1;
      }

      .day:hover .day-number {
        transform: scale(1.1);
      }

      .day-content {
        flex: 1;
      }

      .day-title {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 15px;
        flex-wrap: wrap;
        gap: 15px;
      }

      .day-route {
        font-family: "Lora", serif;
        font-size: 1.5rem;
        font-weight: 700;
        color: #2d3748;
      }

      .day-date {
        background: #e2e8f0;
        color: #4a5568;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 700;
      }

      .day-details-wrapper {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.5s ease-in-out;
        padding: 0 30px;
      }

      .day.active .day-details-wrapper {
        max-height: 500px; /* Adjust as needed */
        padding-bottom: 30px;
      }

      .day-meta {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        flex-wrap: wrap;
      }

      .day-info-item {
        display: flex;
        align-items: center;
        gap: 8px;
        background: #f7fafc;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 0.9rem;
        border: 1px solid #e2e8f0;
      }

      .difficulty-Strenuous {
        background: #fed7d7;
        color: #9b2c2c;
        border-color: #fecaca;
      }
      .difficulty-Moderate {
        background: #fefcbf;
        color: #b45309;
        border-color: #fef9c3;
      }
      .difficulty-Long-moderate {
        background: #ccebfb;
        color: #2c5282;
        border-color: #bee3f8;
      }
      .difficulty-Arrival-day {
        background: #c6f6d5;
        color: #2f855a;
        border-color: #b2f5ea;
      }

      .accommodation {
        background: #f7fafc;
        padding: 20px;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        margin-top: 5px;
      }

      .accommodation-name {
        font-family: "Lora", serif;
        font-weight: 700;
        color: #4a5568;
        margin-bottom: 8px;
        font-size: 1.1rem;
      }

      .accommodation-address {
        font-size: 0.95rem;
        color: #4a5568;
        margin-bottom: 10px;
        font-weight: 500;
      }

      .accommodation-details {
        font-size: 0.9rem;
        color: #718096;
        font-weight: 400;
        line-height: 1.5;
      }

      .footer {
        text-align: center;
        padding: 50px 20px;
        color: #e2e8f0;
        background-color: #2d3748;
        margin-top: 40px;
      }

      .view-toggle {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 40px;
      }

      .toggle-btn {
        font-family: "Lato", sans-serif;
        background: #fff;
        color: #4a5568;
        border: 2px solid #e2e8f0;
        padding: 12px 24px;
        border-radius: 25px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 700;
      }

      .toggle-btn:hover {
        background: #4a5568;
        color: white;
        border-color: #4a5568;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(74, 85, 104, 0.2);
      }

      .toggle-btn.active {
        background: #4a5568;
        color: white;
        border-color: #4a5568;
        box-shadow: 0 4px 15px rgba(74, 85, 104, 0.2);
      }

      .map-container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.05);
        margin-bottom: 40px;
        display: none;
      }

      .map-container.active {
        display: block;
      }

      #map {
        width: 100%;
        height: 600px;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      }

      .map-loading {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 600px;
        background: #f8f9fa;
        border-radius: 15px;
        flex-direction: column;
        gap: 20px;
      }

      .loading-spinner {
        width: 50px;
        height: 50px;
        border: 4px solid #e2e8f0;
        border-top: 4px solid #4a5568;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        color: #718096;
        font-size: 1.1rem;
      }

      .map-info {
        margin-top: 20px;
        padding: 20px;
        background: #f7fafc;
        border-radius: 15px;
        text-align: center;
      }

      .map-info h3 {
        font-family: "Lora", serif;
        color: #2d3748;
        margin-bottom: 10px;
      }

      .map-info p {
        color: #718096;
        margin: 5px 0;
      }

      .floating-btn {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        background: #2d3748;
        color: white;
        border: none;
        border-radius: 30px;
        padding: 15px 25px;
        font-size: 1rem;
        font-weight: 700;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        z-index: 999;
        transition: all 0.3s ease;
        opacity: 0;
        visibility: hidden;
      }

      .floating-btn.visible {
        opacity: 1;
        visibility: visible;
      }

      .back-to-top {
        right: 30px;
        left: auto;
        transform: none;
        width: 50px;
        height: 50px;
      }

      .distance-marker {
        background: rgba(255, 255, 255, 0.8);
        border: 1px solid #ccc;
        border-radius: 5px;
        padding: 2px 5px;
        font-size: 12px;
        font-weight: bold;
        white-space: nowrap;
      }

      @media (max-width: 768px) {
        .hero {
          padding: 60px 20px;
        }
        .hero h1 {
          font-size: 3rem;
        }
        .stats {
          gap: 20px;
        }
        .view-toggle {
          display: none;
        }
        .day {
          margin-bottom: 15px;
        }
        .day-header {
          padding: 20px;
        }
        .day-number {
          width: 50px;
          height: 50px;
          margin-right: 15px;
        }
        .day-route {
          font-size: 1.2rem;
        }
        .day-details-wrapper {
          padding: 0 20px;
        }
        #timelineContainer {
          padding: 20px;
        }
        .back-to-top {
          bottom: 20px;
          right: 20px;
          width: 45px;
          height: 45px;
          font-size: 1.3rem;
        }
        .floating-btn {
          bottom: 20px;
        }
        .forecast {
          flex-wrap: wrap;
          gap: 15px;
        }
        .forecast-day {
          flex-basis: 30%;
        }
      }
    </style>
  </head>
  <body>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css"
    />

    <div class="container">
      <div class="hero">
        <h1>Coast to Coast Walk 2025</h1>
        <p>St Bees to Robin Hoods Bay • Alfred Wainwright's Famous Route</p>

        <div class="weather-container" id="weather-container">
          <div class="weather-location" id="weather-location">
            Loading Weather...
          </div>
          <div class="forecast" id="forecast"></div>
        </div>

        <div class="stats">
          <div class="stat" data-animate="190">
            <span class="stat-number">0</span>
            <span class="stat-label">Miles</span>
          </div>
          <div class="stat" data-animate="17">
            <span class="stat-number">0</span>
            <span class="stat-label">Days</span>
          </div>
          <div class="stat" data-animate="3">
            <span class="stat-number">0</span>
            <span class="stat-label">National Parks</span>
          </div>
        </div>

        <div class="countdown-container">
          <div class="countdown-title">Walk begins in:</div>
          <div class="countdown" id="countdown">
            <div class="countdown-item">
              <span class="countdown-value" id="days">0</span>
              <span class="countdown-label">Days</span>
            </div>
            <div class="countdown-item">
              <span class="countdown-value" id="hours">0</span>
              <span class="countdown-label">Hours</span>
            </div>
            <div class="countdown-item">
              <span class="countdown-value" id="minutes">0</span>
              <span class="countdown-label">Minutes</span>
            </div>
          </div>
        </div>
      </div>

      <div class="view-toggle">
        <button class="toggle-btn active" onclick="showTimeline()">
          📅 Daily Itinerary
        </button>
        <button class="toggle-btn" onclick="showMap()">🗺️ Route Map</button>
      </div>

      <div class="map-container" id="mapContainer">
        <h2
          style="
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            color: #2c3e50;
          "
        >
          Interactive Route Map
        </h2>
        <div class="map-loading" id="mapLoading" style="display: none">
          <div class="loading-spinner"></div>
          <div class="loading-text">Loading interactive map...</div>
        </div>
        <div id="map" style="display: none"></div>
        <div class="map-info">
          <h3>Click on any marker to see accommodation details</h3>
          <p>🟢 Start Point • 🔵 Daily Stops • 🔴 Finish Point</p>
        </div>
      </div>

      <div id="timelineContainer">
        <h2>Daily Itinerary</h2>
        <!-- Daily cards will be dynamically inserted here -->
      </div>
    </div>

    <footer class="footer">
      <p>Alfred Wainwright's Coast to Coast Walk • September 2025</p>
      <p>From the Irish Sea to the North Sea across Northern England</p>
    </footer>

    <button
      class="back-to-top floating-btn"
      id="backToTop"
      onclick="scrollToTop()"
      title="Back to top"
    >
      ↑
    </button>

    <button id="floating-toggle" class="floating-btn">🗺️ Show Map</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script>
      let map;
      let mapInitialized = false;
      let currentView = "timeline";

      const walkData = [
        {
          day: 1,
          date: "2025-09-09",
          from: "Arrival",
          to: "St Bees",
          distance: 0,
          difficulty: "Arrival day",
          accommodation: "Seacote Hotel",
          address: "The Beach, St Bees, Cumbria",
          phone: "01946 822300",
          notes: "Evening meals available • Book in advance",
          coords: [54.49, -3.6],
          color: "green",
        },
        {
          day: 2,
          date: "2025-09-10",
          from: "St Bees",
          to: "Ennerdale",
          distance: 14,
          difficulty: "Strenuous",
          accommodation: "Shepherds Arms",
          address: "Ennerdale Bridge, Cleator, Cumbria",
          phone: "01946 861249",
          notes: "Evening meals available • Table reserved",
          coords: [54.53, -3.44],
          color: "blue",
        },
        {
          day: 3,
          date: "2025-09-11",
          from: "Ennerdale",
          to: "Rosthwaite",
          distance: 14,
          difficulty: "Strenuous",
          accommodation: "Royal Oak",
          address: "Rosthwaite, Borrowdale, Keswick",
          phone: "017687 77214",
          notes: "Dinner, bed & breakfast basis • Check in from 1pm",
          coords: [54.52, -3.15],
          color: "blue",
        },
        {
          day: 4,
          date: "2025-09-12",
          from: "Rosthwaite",
          to: "Grasmere",
          distance: 10,
          difficulty: "Strenuous",
          accommodation: "Swan Hotel",
          address: "Keswick Road, Grasmere",
          phone: "01539 435742",
          notes: "Check in from 3pm • Evening meals available",
          coords: [54.4654, -3.0201],
          color: "blue",
        },
        {
          day: 5,
          date: "2025-09-13",
          from: "Grasmere",
          to: "Glenridding",
          distance: 8,
          difficulty: "Strenuous",
          accommodation: "Ullswater Inn",
          address: "Glenridding, Penrith",
          phone: "015394 35592",
          notes: "Evening meals available • No booking required",
          coords: [54.544, -2.947],
          color: "blue",
        },
        {
          day: 6,
          date: "2025-09-14",
          from: "Glenridding",
          to: "Shap",
          distance: 16,
          difficulty: "Strenuous",
          accommodation: "Kings Arms",
          address: "Main Street, Shap",
          phone: "01931 716277",
          notes: "Evening meals available • Several pubs nearby",
          coords: [54.53, -2.68],
          color: "blue",
        },
        {
          day: 7,
          date: "2025-09-15",
          from: "Shap",
          to: "Orton",
          distance: 8,
          difficulty: "Moderate",
          accommodation: "George Hotel",
          address: "Front Street, Orton",
          phone: "01539 303015",
          notes: "Evening meals available • Book at check-in",
          coords: [54.468, -2.585],
          color: "blue",
        },
        {
          day: 8,
          date: "2025-09-16",
          from: "Orton",
          to: "Kirkby Stephen",
          distance: 12,
          difficulty: "Moderate",
          accommodation: "Old Croft House",
          address: "Market Street, Kirkby Stephen",
          phone: "017683 71638",
          notes: "Check in from 3:30pm • Several restaurants nearby",
          coords: [54.47, -2.35],
          color: "blue",
        },
        {
          day: 9,
          date: "2025-09-17",
          from: "Kirkby Stephen",
          to: "Keld",
          distance: 13,
          difficulty: "Strenuous",
          accommodation: "Keld Lodge",
          address: "Keld, Richmond",
          phone: "01748 886259",
          notes: "Evening meals available • Table reserved",
          coords: [54.407, -2.166],
          color: "blue",
        },
        {
          day: 10,
          date: "2025-09-18",
          from: "Keld",
          to: "Reeth",
          distance: 11,
          difficulty: "Strenuous",
          accommodation: "Ivy Cottage",
          address: "The Green, Reeth",
          phone: "01748 884418",
          notes: "Village centre • Several pubs nearby",
          coords: [54.39, -1.94],
          color: "blue",
        },
        {
          day: 11,
          date: "2025-09-19",
          from: "Reeth",
          to: "Richmond",
          distance: 11,
          difficulty: "Moderate",
          accommodation: "Castle House",
          address: "9 Castle Hill, Richmond",
          phone: "07971 298152",
          notes: "Historic town centre • Many restaurants",
          coords: [54.404, -1.737],
          color: "blue",
        },
        {
          day: 12,
          date: "2025-09-20",
          from: "Richmond",
          to: "Danby Wiske",
          distance: 13,
          difficulty: "Moderate",
          accommodation: "White Swan",
          address: "Danby Wiske, Northallerton",
          phone: "01609 775131",
          notes: "Evening meals 6:30-7:00pm only • Pre-booking essential",
          coords: [54.38, -1.48],
          color: "blue",
        },
        {
          day: 13,
          date: "2025-09-21",
          from: "Danby Wiske",
          to: "Ingleby Cross",
          distance: 11,
          difficulty: "Moderate",
          accommodation: "Park House",
          address: "Ingleby Cross, Northallerton",
          phone: "01609 882899",
          notes: "Evening meals available • Call ahead to arrange",
          coords: [54.426, -1.259],
          color: "blue",
        },
        {
          day: 14,
          date: "2025-09-22",
          from: "Ingleby Cross",
          to: "Clay Bank Top",
          distance: 11,
          difficulty: "Strenuous",
          accommodation: "Wainstones Hotel",
          address: "High Street, Great Broughton",
          phone: "01642 712268",
          notes: "Transport from Clay Bank Top • Check in from 2pm",
          coords: [54.45, -1.16],
          color: "blue",
        },
        {
          day: 15,
          date: "2025-09-23",
          from: "Clay Bank Top",
          to: "Blakey",
          distance: 9,
          difficulty: "Moderate",
          accommodation: "Lion Inn",
          address: "Blakey Ridge, Kirkbymoorside",
          phone: "01751 417320",
          notes: "Remote inn • Evening meals available",
          coords: [54.39, -0.95],
          color: "blue",
        },
        {
          day: 16,
          date: "2025-09-24",
          from: "Blakey",
          to: "Grosmont",
          distance: 15,
          difficulty: "Long moderate",
          accommodation: "Gallery B&B",
          address: "Front Street, Grosmont",
          phone: "07768 743633",
          notes: "Check in from 12:30pm • Near railway station",
          coords: [54.44, -0.73],
          color: "blue",
        },
        {
          day: 17,
          date: "2025-09-25",
          from: "Grosmont",
          to: "Robin Hoods Bay",
          distance: 15,
          difficulty: "Long moderate",
          accommodation: "Wayfarer",
          address: "Station Road, Robin Hoods Bay",
          phone: "01947 880240",
          notes: "Final destination • Coastal village • Celebration time!",
          coords: [54.4299, -0.533],
          color: "red",
        },
      ];

      function getFormattedDate(date) {
        const year = date.getFullYear();
        const month = (date.getMonth() + 1).toString().padStart(2, "0");
        const day = date.getDate().toString().padStart(2, "0");
        return `${year}-${month}-${day}`;
      }

      function buildTimeline() {
        const timelineContainer = document.getElementById("timelineContainer");
        timelineContainer.innerHTML = "<h2>Daily Itinerary</h2>";

        const today = new Date();
        const todayFormatted = getFormattedDate(today);

        walkData.forEach((day) => {
          const dayCard = document.createElement("div");
          dayCard.className = "day";
          dayCard.id = `day-${day.day}`;

          if (day.date < todayFormatted) {
            dayCard.classList.add("completed");
          } else if (day.date === todayFormatted) {
            dayCard.classList.add("today", "active");
          }

          let routeText =
            day.day === 1 ? `Arrival in ${day.to}` : `${day.from} → ${day.to}`;
          let difficultyClass = `difficulty-${day.difficulty.replace(
            /\s+/g,
            "-"
          )}`;
          let dayNumberContent = day.date < todayFormatted ? "✔" : day.day;

          dayCard.innerHTML = `
                    <div class="day-header">
                        <div class="day-number"><span>${dayNumberContent}</span></div>
                        <div class="day-content">
                            <div class="day-title">
                                <div class="day-route">${routeText}</div>
                                <div class="day-date">${new Date(day.date)
                                  .toDateString()
                                  .slice(0, -5)}</div>
                            </div>
                        </div>
                    </div>
                    <div class="day-details-wrapper">
                        <div class="day-meta">
                            <div class="day-info-item">
                                <span>🥾</span>
                                <span>${
                                  day.distance > 0
                                    ? day.distance + " miles"
                                    : "Arrival Day"
                                }</span>
                            </div>
                            <div class="day-info-item ${difficultyClass}">
                                <span>${
                                  day.difficulty === "Strenuous" ? "🔥" : "⚡"
                                }</span>
                                <span>${day.difficulty}</span>
                            </div>
                        </div>
                        <div class="accommodation">
                            <div class="accommodation-name">${
                              day.accommodation
                            }</div>
                            <div class="accommodation-address">${
                              day.address
                            }</div>
                            <div class="accommodation-details">📞 ${
                              day.phone
                            } • ${day.notes}</div>
                        </div>
                    </div>
                `;
          timelineContainer.appendChild(dayCard);
        });

        document.querySelectorAll(".day-header").forEach((header) => {
          header.addEventListener("click", () => {
            header.parentElement.classList.toggle("active");
          });
        });
      }

      function initMap() {
        try {
          if (
            typeof L === "undefined" ||
            !document.getElementById("map") ||
            mapInitialized
          ) {
            return;
          }

          map = L.map("map");
          L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: "© OpenStreetMap contributors",
          }).addTo(map);

          const routeCoordinates = walkData.map((day) => day.coords);
          L.polyline(routeCoordinates, {
            color: "#4a5568",
            weight: 4,
            opacity: 0.8,
          }).addTo(map);

          const today = new Date();
          const todayFormatted = getFormattedDate(today);

          for (let i = 1; i < walkData.length; i++) {
            const prevPoint = walkData[i - 1].coords;
            const currentPoint = walkData[i].coords;
            const distance = walkData[i].distance;

            const midPoint = [
              (prevPoint[0] + currentPoint[0]) / 2,
              (prevPoint[1] + currentPoint[1]) / 2,
            ];

            const icon = L.divIcon({
              className: "distance-marker",
              html: `${distance} mi`,
            });

            L.marker(midPoint, { icon: icon }).addTo(map);
          }

          walkData.forEach(function (day) {
            let markerColor;
            if (day.date < todayFormatted) {
              markerColor = "#a0aec0"; // Completed (Grey)
            } else if (day.date === todayFormatted) {
              markerColor = "#48bb78"; // Today (Green)
            } else {
              markerColor = "#3b82f6"; // Future (Blue)
            }

            if (day.day === 1) markerColor = "#48bb78"; // Start is always green
            if (day.day === walkData.length) markerColor = "#e53e3e"; // End is always red

            let marker = L.circleMarker(day.coords, {
              radius: 8,
              fillColor: markerColor,
              color: "white",
              weight: 2,
              opacity: 1,
              fillOpacity: 0.9,
            }).addTo(map);

            let popupContent = `
                        <div style="font-family: 'Lato', sans-serif;">
                            <h3 style="margin: 0 0 10px 0; color: #2c3e50; font-size: 1.1rem; font-family: 'Lora', serif;">
                                Day ${day.day}: ${day.accommodation}
                            </h3>
                            <p style="margin: 5px 0; color: #6b7280; font-size: 0.9rem;">📅 ${new Date(
                              day.date
                            )
                              .toDateString()
                              .slice(0, -5)}</p>
                            <p style="margin: 5px 0; color: #6b7280; font-size: 0.9rem;">📍 ${
                              day.address
                            }</p>
                            <p style="margin: 5px 0; color: #6b7280; font-size: 0.9rem;">📞 ${
                              day.phone
                            }</p>
                            <p style="margin: 10px 0 0 0; color: #4a5568; font-size: 0.9rem; font-weight: 500;">${
                              day.notes
                            }</p>
                        </div>`;
            marker.bindPopup(popupContent);
          });

          mapInitialized = true;
        } catch (error) {
          console.error("Error initializing map:", error);
        }
      }

      function showTimeline() {
        document.getElementById("timelineContainer").style.display = "block";
        document.getElementById("mapContainer").style.display = "none";
        document
          .querySelectorAll(".toggle-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.querySelectorAll(".toggle-btn")[0].classList.add("active");
        document.getElementById("floating-toggle").innerHTML = "🗺️ Show Map";
        currentView = "timeline";
      }

      function showMap() {
        document.getElementById("timelineContainer").style.display = "none";
        document.getElementById("mapContainer").style.display = "block";
        document
          .querySelectorAll(".toggle-btn")
          .forEach((btn) => btn.classList.remove("active"));
        document.querySelectorAll(".toggle-btn")[1].classList.add("active");
        document.getElementById("floating-toggle").innerHTML =
          "📅 Show Itinerary";
        currentView = "map";

        const mapElement = document.getElementById("map");
        const mapLoading = document.getElementById("mapLoading");

        if (!mapInitialized) {
          mapLoading.style.display = "flex";
          mapElement.style.display = "none";

          setTimeout(() => {
            if (typeof L !== "undefined" && document.getElementById("map")) {
              initMap();
              mapLoading.style.display = "none";
              mapElement.style.display = "block";
              setTimeout(() => {
                if (map) {
                  map.invalidateSize();
                  const bounds = L.polyline(
                    walkData.map((d) => d.coords)
                  ).getBounds();
                  map.fitBounds(bounds, { padding: [50, 50] });
                }
              }, 100);
            }
          }, 500);
        } else {
          setTimeout(() => {
            if (map) {
              map.invalidateSize();
              const bounds = L.polyline(
                walkData.map((d) => d.coords)
              ).getBounds();
              map.fitBounds(bounds, { padding: [50, 50] });
            }
          }, 100);
        }
      }

      function animateStats() {
        document.querySelectorAll(".stat").forEach((stat) => {
          const target = parseInt(stat.getAttribute("data-animate"));
          const numberElement = stat.querySelector(".stat-number");
          let current = 0;
          const increment = target / 50;
          const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
              current = target;
              clearInterval(timer);
            }
            numberElement.textContent = Math.floor(current);
          }, 40);
        });
      }

      function updateCountdown() {
        const walkDate = new Date("2025-09-09T10:00:00");
        const now = new Date();
        const diff = walkDate - now;

        if (diff > 0) {
          const days = Math.floor(diff / (1000 * 60 * 60 * 24));
          const hours = Math.floor(
            (diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
          );
          const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));

          document.getElementById("days").textContent = days;
          document.getElementById("hours").textContent = hours;
          document.getElementById("minutes").textContent = minutes;
        } else {
          document.querySelector(".countdown-container").innerHTML =
            '<div class="countdown-title">🎉 The Coast to Coast Walk has begun! 🎉</div>';
        }
      }

      function scrollToTop() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function toggleFloatingButtons() {
        const backToTopButton = document.getElementById("backToTop");
        const floatingToggle = document.getElementById("floating-toggle");
        if (window.pageYOffset > 300) {
          backToTopButton.classList.add("visible");
          floatingToggle.classList.add("visible");
        } else {
          backToTopButton.classList.remove("visible");
          floatingToggle.classList.remove("visible");
        }
      }

      document
        .getElementById("floating-toggle")
        .addEventListener("click", () => {
          if (currentView === "timeline") {
            showMap();
          } else {
            showTimeline();
          }
        });

      async function fetchHeroWeatherData() {
        const today = new Date();
        const todayFormatted = getFormattedDate(today);
        let location;

        // Find current day's location
        const currentDay = walkData.find((day) => day.date === todayFormatted);

        if (currentDay) {
          location = currentDay;
        } else if (today < new Date(walkData[0].date)) {
          // Before the walk
          location = walkData[0];
        } else {
          // After the walk
          location = walkData[walkData.length - 1];
        }

        document.getElementById(
          "weather-location"
        ).textContent = `7-Day Forecast for ${location.to}`;

        const url = `https://api.open-meteo.com/v1/forecast?latitude=${location.coords[0]}&longitude=${location.coords[1]}&daily=weathercode,temperature_2m_max,temperature_2m_min&forecast_days=7&timezone=auto`;

        try {
          const response = await fetch(url);
          const data = await response.json();
          if (data.daily) {
            const forecastContainer = document.getElementById("forecast");
            forecastContainer.innerHTML = ""; // Clear previous
            for (let i = 0; i < 7; i++) {
              const dayName = new Date(data.daily.time[i]).toLocaleDateString(
                "en-US",
                { weekday: "short" }
              );
              const icon = getWeatherIcon(data.daily.weathercode[i]);
              const minTemp = Math.round(data.daily.temperature_2m_min[i]);
              const maxTemp = Math.round(data.daily.temperature_2m_max[i]);

              forecastContainer.innerHTML += `
                            <div class="forecast-day">
                                <div class="day-name">${dayName}</div>
                                <div class="icon">${icon}</div>
                                <div class="temps">${minTemp}°/${maxTemp}°</div>
                            </div>
                        `;
            }
          }
        } catch (error) {
          console.error("Error fetching hero weather:", error);
          document.getElementById("weather-location").textContent =
            "Could not load weather";
        }
      }

      function getWeatherIcon(code) {
        if ([0, 1].includes(code)) return "☀️";
        if ([2].includes(code)) return "⛅️";
        if ([3].includes(code)) return "☁️";
        if ([45, 48].includes(code)) return "🌫️";
        if ([51, 53, 56].includes(code)) return "🌦️"; // Light Drizzle
        if ([55, 57, 61, 63, 66, 80, 81].includes(code)) return "🌧️"; // Drizzle/Rain
        if ([65, 67, 82].includes(code)) return "🌧️"; // Heavy Rain
        if ([71, 73, 75, 77, 85, 86].includes(code)) return "❄️";
        if ([95, 96, 99].includes(code)) return "⛈️"; // Thunderstorm
        return "🌡️";
      }

      document.addEventListener("DOMContentLoaded", function () {
        buildTimeline();
        fetchHeroWeatherData();
        setTimeout(animateStats, 500);
        updateCountdown();
        setInterval(updateCountdown, 60000);
        window.addEventListener("scroll", toggleFloatingButtons);
        toggleFloatingButtons();
      });
    </script>
  </body>
</html>
